import './index.scss';
import {NavLink, useLocation, useNavigate} from "react-router-dom";
import {useEffect, useRef, useState} from "react";
import {MdLogout} from "react-icons/md";
import {usePopup} from "../../../components/Popup/PopupContext.jsx";

const AccounterLeftBar = () => {
    const location = useLocation();
    const [productsOpen, setProductsOpen] = useState(false);
    const dropdownRef = useRef(null);

    // Eğer rota /superAdmin/products/... ise dropdown otomatik açık olsun
    useEffect(() => {
        if (location.pathname.startsWith("/superAdmin/products")) {
            setProductsOpen(true);
        }
    }, [location.pathname]);
    const showPopup = usePopup()
    const toggleProducts = () => setProductsOpen(o => !o);
    const navigate = useNavigate();
    const handleLogout = () => {
        // Bütün cookies sil
        document.cookie.split(";").forEach(cookie => {
            const name = cookie.split("=")[0].trim();
            document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;`;
        });
        localStorage.setItem('auth-change', Date.now());
        showPopup("Sistemdən çıxış edildi","Hesabdan uğurla çıxış etdiniz.","success")
        // Ana səhifəyə yönləndir
        navigate('/');
    };
    return (
        <aside className="sidebar">
            <ul className="sidebar__menu-accounter">


{/*                <li className={location.pathname.startsWith("/accounter/history")  ? "sidebar__menu-accounter-item active" : "sidebar__menu-accounter-item"}>*/}
{/*                    <span className="sidebar__menu-accounter-icon">*/}
{/*                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">*/}
{/*  <path*/}
{/*      d="M12.0112 0.71875C9.18296 0.720258 6.46854 1.83308 4.45313 3.81733V0.71875H3.01563V6.46875H8.76563V5.03125H5.27461C6.14597 4.12302 7.19185 3.40019 8.34947 2.90615C9.50709 2.41211 10.7526 2.15704 12.0112 2.15625C17.157 2.15625 21.3438 6.34297 21.3438 11.4888C21.3438 16.6346 17.157 20.8213 12.0112 20.8213C6.86543 20.8213 2.67871 16.6346 2.67871 11.4888H1.24121C1.24121 13.6189 1.87286 15.7012 3.05628 17.4723C4.23971 19.2434 5.92176 20.6238 7.88972 21.439C9.85769 22.2541 12.0232 22.4674 14.1124 22.0519C16.2015 21.6363 18.1206 20.6105 19.6268 19.1043C21.133 17.5981 22.1588 15.6791 22.5743 13.5899C22.9899 11.5007 22.7766 9.33523 21.9614 7.36726C21.1463 5.39929 19.7659 3.71725 17.9947 2.53382C16.2236 1.3504 14.1413 0.718747 12.0112 0.71875Z"*/}
{/*      fill="black"/>*/}
{/*  <path d="M11.2812 5.02905L11.2572 12.9375H17.0312V11.5H12.6991L12.7187 5.03346L11.2812 5.02905Z" fill="black"/>*/}
{/*</svg>*/}
{/*                    </span> <NavLink to={"/accounter/history"} className="link">*/}
{/*                    Tarixcə*/}
{/*                </NavLink>*/}
{/*                </li>*/}
                <li className={location.pathname.startsWith("/accounter/borc")  ? "sidebar__menu-accounter-item active" : "sidebar__menu-accounter-item"}>
                    <span className="sidebar__menu-accounter-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
  <path d="M5.39961 2.39844C4.92222 2.39844 4.46438 2.58808 4.12682 2.92565C3.78925 3.26321 3.59961 3.72105 3.59961 4.19844V19.7984C3.59961 20.2758 3.78925 20.7337 4.12682 21.0712C4.46438 21.4088 4.92222 21.5984 5.39961 21.5984H13.7996C14.277 21.5984 14.7348 21.4088 15.0724 21.0712C15.41 20.7337 15.5996 20.2758 15.5996 19.7984V17.9984C15.5996 17.8393 15.5364 17.6867 15.4239 17.5742C15.3114 17.4617 15.1587 17.3984 14.9996 17.3984C14.504 17.3984 14.1872 17.276 13.9724 17.1152C13.754 16.952 13.5844 16.7028 13.4636 16.3676C13.2068 15.662 13.1996 14.7272 13.1996 13.7984C13.1996 13.7195 13.184 13.6414 13.1537 13.5685C13.1235 13.4956 13.0791 13.4294 13.0232 13.3736L12.68 13.0292L11.2244 11.5736C10.664 11.0132 10.4996 10.6376 10.4684 10.4276C10.4444 10.2596 10.4948 10.1468 10.6148 10.0316C10.8716 9.78564 11.0552 9.61884 11.2628 9.56844C11.3864 9.53724 11.6684 9.51564 12.1748 10.022L15.7748 13.622C15.8873 13.7347 16.04 13.7981 16.1992 13.7982C16.278 13.7982 16.3561 13.7828 16.429 13.7526C16.5018 13.7225 16.568 13.6783 16.6238 13.6226C16.6796 13.5669 16.7239 13.5008 16.7541 13.428C16.7843 13.3552 16.7999 13.2771 16.7999 13.1983C16.8 13.1194 16.7845 13.0413 16.7544 12.9685C16.7243 12.8956 16.6801 12.8294 16.6244 12.7736L15.5996 11.75V8.04684L18.6716 11.1188C18.8389 11.286 18.9717 11.4844 19.0623 11.7029C19.1529 11.9214 19.1996 12.1555 19.1996 12.392V20.9984C19.1996 21.1576 19.2628 21.3102 19.3753 21.4227C19.4879 21.5352 19.6405 21.5984 19.7996 21.5984C19.9587 21.5984 20.1114 21.5352 20.2239 21.4227C20.3364 21.3102 20.3996 21.1576 20.3996 20.9984V12.392C20.3994 11.5967 20.0835 10.8341 19.5212 10.2716L15.5996 6.35004V4.19844C15.5996 3.72105 15.41 3.26321 15.0724 2.92565C14.7348 2.58808 14.277 2.39844 13.7996 2.39844H5.39961ZM14.3996 6.59844V10.55L13.0244 9.17364C12.3308 8.48004 11.6396 8.24124 10.9784 8.40204C10.8485 8.43394 10.7225 8.48022 10.6028 8.54004C10.0664 8.38439 9.50111 8.35569 8.95169 8.45622C8.40226 8.55675 7.88376 8.78374 7.43721 9.11924C6.99065 9.45474 6.62829 9.88954 6.37878 10.3893C6.12927 10.889 5.99945 11.4399 5.99961 11.9984C5.99956 12.6944 6.20123 13.3754 6.5802 13.9591C6.95918 14.5428 7.49922 15.0041 8.13495 15.2873C8.77068 15.5704 9.47486 15.6632 10.1622 15.5545C10.8496 15.4457 11.4907 15.14 12.008 14.6744C12.0284 15.368 12.098 16.1264 12.3356 16.778C12.5132 17.2664 12.7964 17.7332 13.2524 18.074L13.2596 18.0812C12.8942 18.1962 12.575 18.4246 12.3484 18.7335C12.1218 19.0423 11.9996 19.4154 11.9996 19.7984V20.3984H7.19961V19.7984C7.19961 19.321 7.00997 18.8632 6.6724 18.5256C6.33484 18.1881 5.877 17.9984 5.39961 17.9984H4.79961V5.99844H5.39961C5.877 5.99844 6.33484 5.8088 6.6724 5.47123C7.00997 5.13366 7.19961 4.67583 7.19961 4.19844V3.59844H11.9996V4.19844C11.9996 4.67583 12.1893 5.13366 12.5268 5.47123C12.8644 5.8088 13.3222 5.99844 13.7996 5.99844H14.3996V6.59844ZM14.3996 19.7984V19.8092C14.3968 19.9665 14.3323 20.1163 14.2201 20.2265C14.1079 20.3367 13.9569 20.3985 13.7996 20.3984H13.1996V19.7984C13.1996 19.6393 13.2628 19.4867 13.3753 19.3742C13.4879 19.2617 13.6405 19.1984 13.7996 19.1984H14.3996V19.7984ZM7.19961 11.9984C7.19962 11.3881 7.43216 10.8007 7.84992 10.3557C8.26769 9.91077 8.83928 9.64169 9.44841 9.60324C9.29961 9.87924 9.22401 10.2152 9.28161 10.6028C9.36681 11.1812 9.73521 11.7824 10.3748 12.422L11.4632 13.5104C11.1508 13.8955 10.7267 14.1743 10.2494 14.3085C9.77201 14.4428 9.26479 14.4259 8.79745 14.2601C8.3301 14.0944 7.92555 13.788 7.63944 13.383C7.35332 12.978 7.19967 12.4943 7.19961 11.9984ZM5.99961 3.59844V4.19844C5.99961 4.35757 5.93639 4.51018 5.82387 4.6227C5.71135 4.73522 5.55874 4.79844 5.39961 4.79844H4.79961V4.19844C4.79961 4.03931 4.86282 3.8867 4.97535 3.77417C5.08787 3.66165 5.24048 3.59844 5.39961 3.59844H5.99961ZM4.79961 19.1984H5.39961C5.55874 19.1984 5.71135 19.2617 5.82387 19.3742C5.93639 19.4867 5.99961 19.6393 5.99961 19.7984V20.3984H5.39961C5.24048 20.3984 5.08787 20.3352 4.97535 20.2227C4.86282 20.1102 4.79961 19.9576 4.79961 19.7984V19.1984ZM14.3996 4.79844H13.7996C13.6405 4.79844 13.4879 4.73522 13.3753 4.6227C13.2628 4.51018 13.1996 4.35757 13.1996 4.19844V3.59844H13.7996C13.9587 3.59844 14.1114 3.66165 14.2239 3.77417C14.3364 3.8867 14.3996 4.03931 14.3996 4.19844V4.79844Z" fill="black"/>
</svg>
                    </span> <NavLink to={"/accounter/borc"} className="link">
                    Borc
                </NavLink>
                </li>
            </ul>
            <div>
                <button className={"logOut"} onClick={handleLogout}>
                    <MdLogout style={{
                        fontSize: "18px",
                    }}/>
                    <div>Çıxış et</div>
                </button>
            </div>
        </aside>
    )
        ;
};

export default AccounterLeftBar;